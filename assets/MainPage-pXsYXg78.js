import{r as a,j as s,C as q,S as F}from"./index-Pp-rTOqm.js";import{P as f}from"./index-zPFfC8LZ.js";import{E as S}from"./ErrorMassage-dIkj-3ov.js";import{f as R,E as B}from"./ErrorBoundary-eOgfbttF.js";const N=()=>{const[i,e]=a.useState(!1),[c,r]=a.useState(null),C=a.useCallback(async(l,h="GET",d=null,n={"Content-Type":"application/json"})=>{e(!0);try{const o=await fetch(l,{method:h,body:d,headers:n});if(!o.ok)throw new Error(`Could not fetch ${l}, status: ${o.status}`);const g=await o.json();return e(!1),g}catch(o){throw e(!1),r(o.message),o}},[]),p=a.useCallback(()=>r(null),[]);return{loading:i,request:C,error:c,clearError:p}},T=()=>{const{loading:i,request:e,error:c,clearError:r}=N(),C="https://api.thecatapi.com/v1/images/",p="live_x6cc8XljbBNFTq4x2Rj7xeAVhNY32OhQrTmLfqJWXm4ghLPwOtawagUWKHczBSbx",l=33,h=async(n=l)=>(await e(`${C}search?limit=15&order=ASC&page=${n}&api_key=${p}`)).map(d),d=n=>({id:n.id,thumbnail:n.url,favorite:!1});return{loading:i,error:c,clearError:r,getAllCats:h}},P="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_1_2165)'%3e%3cpath%20d='M33%206C29.52%206%2026.18%207.62%2024%2010.18C21.82%207.62%2018.48%206%2015%206C8.84%206%204%2010.84%204%2017C4%2024.56%2010.8%2030.72%2021.1%2040.08L24%2042.7L26.9%2040.06C37.2%2030.72%2044%2024.56%2044%2017C44%2010.84%2039.16%206%2033%206ZM24.2%2037.1L24%2037.3L23.8%2037.1C14.28%2028.48%208%2022.78%208%2017C8%2013%2011%2010%2015%2010C18.08%2010%2021.08%2011.98%2022.14%2014.72H25.88C26.92%2011.98%2029.92%2010%2033%2010C37%2010%2040%2013%2040%2017C40%2022.78%2033.72%2028.48%2024.2%2037.1Z'%20fill='%23F24E1E'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_1_2165'%3e%3crect%20width='48'%20height='48'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",x=i=>{const[e,c]=a.useState([]),[r,C]=a.useState(18),[p,l]=a.useState(!1),[h,d]=a.useState(!0),{loading:n,error:o,getAllCats:g}=T(),{favoriteCatList:_,addCatInFavoriteList:b,removeCatInFavoriteList:j}=i;a.useEffect(()=>()=>{m(r)},[]);function m(t){d(!0),g(t).then(y).finally(d(!1))}function y(t){c(v=>[...v,...t]),C(v=>v+15),l(t.length<15)}function E(t){t.favorite?j(t):b(t),t.favorite=!t.favorite}const w=a.useCallback(t=>{const v=t.map(u=>(_.map(L=>L.id===u.id&&(u=L)),s.jsx("li",{className:"cats__item",style:{backgroundImage:`url(${u.thumbnail})`},tabIndex:"0",children:s.jsx("img",{src:u.favorite?R:P,alt:"cat",className:"cats__like",onClick:()=>E(u),tabIndex:"0"})},u.id)));return s.jsx("ul",{className:"cats__grid",children:v})},[e])(e),k=n&&s.jsx(F,{}),I=o&&s.jsx(S,{});return s.jsxs(q,{children:[w,k,I,s.jsx("button",{className:"cats__button",disabled:h,onClick:()=>m(r),style:{display:p?"none":"block"},children:s.jsx("div",{className:"cats__button-text",children:"Хочу ещё"})})]})};x.propTypes={favoriteCatList:f.array.isRequired,addCatInFavoriteList:f.func.isRequired,removeCatInFavoriteList:f.func.isRequired};const $=i=>{const{favoriteCatList:e,addCatInFavoriteList:c,removeCatInFavoriteList:r}=i;return s.jsx(B,{children:s.jsx(x,{favoriteCatList:e,addCatInFavoriteList:c,removeCatInFavoriteList:r})})};$.propTypes={favoriteCatList:f.array.isRequired,addCatInFavoriteList:f.func.isRequired,removeCatInFavoriteList:f.func.isRequired};export{$ as default};
